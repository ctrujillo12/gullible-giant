---
import { getCollection } from 'astro:content';
import Layout from '../layouts/ShopLayout.astro';

const posts = await getCollection('posts');

// sort newest first
posts.sort((a, b) => new Date(b.data.date) - new Date(a.data.date));

// render each post’s content
const rendered = await Promise.all(posts.map((p) => p.render()));
---

<Layout>
  <h1>My Blog</h1>
  {rendered.map((r, i) => (
    <article style="margin-bottom: 2rem;">
      <h2>{posts[i].data.title}</h2>
      <p><em>{posts[i].data.date}</em></p>
      <r.Content />   <!-- ✅ render the markdown component here -->
    </article>
  ))}
</Layout>
