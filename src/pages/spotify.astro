---
import Layout from '../layouts/ShopLayout.astro';
// import { authUrl } from '../utils/spotify/spotconstants';

// const token = Astro.cookies.get('spotify_token')?.value;
// let topTracks = [];

// if (token) {
//   try {
//     const res = await fetch('/api/spotify/user-data');
//     if (res.ok) {
//       const data = await res.json();
//       topTracks = data.items || [];
//     } else {
//       console.error('Failed to fetch tracks:', await res.text());
//     }
//   } catch (e) {
//     console.error('Spotify API failed:', e);
//   }
// }
---

<Layout title="My Spotify">
  <!-- <main>
    <h1 class="graduate-pink-center">coming soon</h1>

    {topTracks
      .sort((a: any, b: any) => b.popularity - a.popularity)
      .map((track: any) => (
        <li class="py-1">
          {track.name} â€” {track.artists.map((artist: any) => artist.name).join(", ")}
        </li>
      ))}

      </ul>
    ) : (
      <div style="text-align: center; margin-top: 2rem;">
        <a href={authUrl} class="login-button">Log in with Spotify</a>
      </div>
    )}
  </main> -->

  <style>
    .graduate-pink-center {
      color: #ff66cc;
      text-align: center;
      font-family: 'Graduate', cursive;
    }

    .pink-text {
      color: #ff66cc;
      font-size: 1.2rem;
      text-align: center;
      margin-bottom: 1rem;
    }

    .login-button {
      display: inline-block;
      background-color: #1db954;
      color: white;
      font-weight: bold;
      padding: 0.5rem 1rem;
      border-radius: 30px;
      text-decoration: none;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }

    .login-button:hover {
      background-color: #1ed760;
    }
  </style>
</Layout>




<!-- ---
import Layout from '../layouts/ShopLayout.astro';
import { clientId, redirectUri, scopes } from '../lib/spotifyTokenStore';
const authUrl = `https://accounts.spotify.com/authorize?client_id=${clientId}&response_type=code&redirect_uri=${encodeURIComponent(redirectUri)}&scope=${scopes}`;
--- -->
<Layout>
  <html>
    <head><title>Spotify Login</title></head>
    <body>
      <h1>Login with Spotify</h1>
      <!-- <a href={authUrl}><button>Login</button></a> -->
    </body>
  </html>
</Layout>
